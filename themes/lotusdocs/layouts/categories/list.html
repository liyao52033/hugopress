{{ define "main" }}

	{{/* .Kind 为 "taxonomy" → 分类首页（显示所有分类，不显示文章）*/}}
	{{/* .Kind 为 "term" → 单个分类页（显示该分类下文章）*/}}

	<div class="container py-4">
		 <a href="/categories/">
			<h1 class="mb-4">所有分类</h1>
		</a>
		<div class="row g-3">
			{{ range $name, $taxonomy := .Site.Taxonomies.categories }}
			<div class="col-md-4">
				<a href='{{ "/categories/" | relURL }}{{ $name | urlize }}' class="text-decoration-none">
				<div class="card h-100 shadow-sm">
					<div class="card-body d-flex justify-content-between align-items-center">
					<span class="fw-bold">{{ $name }}</span>
					<span class="badge rounded-pill" style="background-color: #0066ff; color: white;">{{ .Count }}篇</span>
					</div>
				</div>
				</a>
			</div>
			{{ end }}
		</div>
	</div>

	{{ $pages := .Pages }}
	{{ if eq .Kind "taxonomy" }}
		{{/*  如果是分类首页，则显示所有文章 */}}
		{{ $pages = where .Site.RegularPages "Type" "docs" }}
	{{ end }}

	<div class="container py-4">
		<h1>
		{{ if eq .Kind "taxonomy" }}
			所有文章 ({{ len $pages }} 篇)
		{{ else }}
			{{ .Title }} 分类下的文章 
		{{ end }}
		</h1>
	</div>

	<div class="container py-4">
		{{ if $pages }}
			<div class="row g-4">
			{{ range $pages }}
			<div class="col-md-4">
				<div class="card h-100 shadow-sm">
				<div class="card-body">
					<h5 class="card-title">
					<a href="{{ .Permalink }}" class="text-decoration-none">{{ .Title }}</a>
					</h5>
					<p class="card-text text-muted">
					{{ if .Description }}
						{{ .Description }}
					{{ else }}
						暂无摘要
					{{ end }}
					</p>
				</div>
				<div class="card-footer d-flex justify-content-between align-items-center">
					<small class="text-muted">发表于 {{ .Date.Format "2006-01-02" }}</small>
					{{ $wordCount := len (.Content | plainify) }}
					{{ $readingSpeed := .Site.Params.reading_speed | default 300 }}
					{{ $readingTime := math.Ceil (div (float $wordCount) $readingSpeed) }}
					<small class="text-muted">⏱️ {{ $readingTime }} 分钟阅读</small>
				</div>
				</div>
			</div>
			{{ end }}
			</div>
		{{ else }}
			<div class="alert alert-warning">该分类下暂无文章。</div>
		{{ end }}
	</div>



{{ end }}
